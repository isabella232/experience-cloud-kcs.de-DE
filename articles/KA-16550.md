---
title: „Ausführen einer Konsistenzprüfung des Datenspeichers mit oak-run“
description: Beschreibung
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: „KCS“
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/How-to-run-a-datastore-consistency-check-via-oak-run-AEM.html"
bug: false
article-created-by: Cedric Latimier
article-created-date: "1/10/2023 9:20:59 AM"
article-published-by: Cedric Latimier
article-published-date: "1/10/2023 9:21:59 AM"
version-number: 5
article-number: KA-16550
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=2863b416-c890-ed11-aad1-6045bd006268"
source-git-commit: a02880ad907e781ff9691c24c6c35a5a1e8d206c
workflow-type: tm+mt
source-wordcount: '330'
ht-degree: 59%

---

# Ausführen einer Konsistenzprüfung des Datenspeichers mit oak-run

## Beschreibung {#description}

<br>Umgebung<br><br>
- Adobe Experience Manager 6.4
- Oak 1.8.8 und neuere Versionen



<b>Problem/Symptome</b>
Das Tool &quot;oak-run&quot;ist hilfreich, wenn Sie einen Fehler wie diesen feststellen:


| `09.11.2017 13:42:17.512 *WARN* async-index-update-async org.apache.jackrabbit.oak.plugins.blob.datastore.DataStoreBlobStore Error occurred while loading bytes from steam while fetching for id record ID`<br><br>`java.util.concurrent.ExecutionException: java.io.IOException: org.apache.jackrabbit.core.data.DataStoreException: Record record ID does not exist`<br><br>`Caused by: java.io.IOException: org.apache.jackrabbit.core.data.DataStoreException: Record record ID does not exist` |
| --- |



|  |
| --- |

<br>Im Gegensatz zu` /system/console/repositorycheck` Benutzeroberfläche überprüft das Oak-Run-Tool die ausgeblendeten Lucene-Indexdateien unter `/oak:` -Index zusätzlich zum Rest der Inhaltspfade.  Mit diesem Tool haben Sie, wie [hier](https://helpx.adobe.com/experience-manager/kb/oak-blobstore-inconsistency-blobId.html) dokumentiert, die Möglichkeit, Indexdateien auf dem Datenspeicher wiederherzustellen oder nur die beschädigten Indizes neu zu erstellen, anstatt alle Indizes neu zu indizieren.

## Lösung {#resolution}


1. [Laden Sie oak-run jar 1.8.8 oder eine neuere Version](https://repo1.maven.org/maven2/org/apache/jackrabbit/oak-run/1.6.6/oak-run-1.6.6.jar) auf Ihren AEM-Server herunter.
2. Führen Sie den folgenden Befehl aus (tauschen Sie jedoch die Pfade zum Segmentspeicher und Datenspeicher aus, um sie Ihrer Umgebung anzupassen):

   <b>`java -jar oak-run-*.jar datastorecheck --consistency --ref --id --fds crx-quickstart/install/org.apache.jackrabbit.oak.plugins.blob.datastore.FileDataStore.config --repoHome crx-quickstart/repository --store crx-quickstart/repository/segmentstore --dump temp --verbose --track`</b>


3. Der Befehl gibt eine Konsistenzprüfung des Datenspeichers aus.
4. Verwenden Sie die Ausgabe und folgen Sie [diesem Artike](https://helpx.adobe.com/experience-manager/kb/oak-blobstore-inconsistency-blobId.html), um fehlende Dateien wiederherzustellen oder zu reparieren.


Die Konsistenzprüfung für den Datenspeicher kann auch verwendet werden, um alle Blob-Verweise im Knotenspeicher und alle Blob-IDs im Datenspeicher aufzulisten. Verwenden Sie den folgenden Befehl:

`$ java-jar oak-run-*.jar datastorecheck --id --ref --consistency \`

`--store | \`

`--s3ds |--fds \`

`--dump \`

`--track`

Geben Sie eine oder mehrere der folgenden verfügbaren Optionen an:

- —id - Listet alle IDs im Datenspeicher auf.
- —ref - Listet alle Blob-Referenzen im Knotenspeicher auf.
- —consistency - Auflistung aller fehlenden Blobs durch eine Konsistenzprüfung.


Die folgenden Optionen sind fakultativ:

- —store - Pfad zum Segmentspeicher von mongo uri (erforderlich für —ref und —consistency options oben).
- —dump - Pfad, in dem die Dateien abgelegt werden sollen (optional). Andernfalls werden die Dateien im Verzeichnis „user/tmp“ abgelegt.
- —s3ds - Pfad zur S3DataStore-Konfigurationsdatei.
- —fds - Pfad zur FileDataStore-Konfigurationsdatei (&quot;path&quot;-Eigenschaft ist obligatorisch).
- —track - Pfad des lokalen Repository-Stammordners (optional). Dadurch wird eine Kopie der zu verfolgenden heruntergeladenen Blob-IDs platziert.


<b>Ähnliche Themen</b>

[Oak DataStore-Prüfung](https://github.com/apache/jackrabbit-oak/tree/1.8/oak-run#oak-datastore-check)
