---
title: Verwenden und Verstehen von Variablen
description: Beschreibung
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: 10/21/2021 5:36:09 PM
article-published-by: Cedric Latimier
article-published-date: 1/18/2022 1:51:43 PM
version-number: 1
article-number: KA-17487
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=1280b65e-9532-ec11-b6e5-000d3a5ba97a
exl-id: 86b5580e-134f-40d7-a126-45a38b8beaec
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '926'
ht-degree: 1%

---

# Verwenden und Verstehen von Variablen

## Beschreibung


In diesem Dokument wird erläutert, wie Sie die Leistungsfähigkeit von Variablen in [!DNL Apache] Webserver und in den Konfigurationsdateien des Dispatcher-Moduls.
<br><br><br><br>Variablen<br><br><br><br> <br><br>
[!DNL Apache] unterstützt Variablen und ab Version 4.1.9 der [!DNL Dispather] -Modul unterstützt es sie auch!

Wir können diese nutzen, um eine Menge nützlicher Dinge zu tun, wie:

- Stellen Sie sicher, dass alles, was umgebungsspezifisch ist, nicht inline in den Konfigurationen ist, sondern extrahiert wird, um sicherzustellen, dass Konfigurationsdateien aus dev in prod mit derselben funktionalen Ausgabe funktionieren.
- Wechsel zu Funktionen und Änderung der Protokollebenen unveränderlicher Dateien, die AMS bereitstellt, lassen eine Änderung nicht zu.
- Ändern Sie, welche enthält, basierend auf Variablen wie `RUNMODE` und `ENV_TYPE`
- Übereinstimmung `DocumentRoot`&quot;s und `VirtualHost` DNS-Namen zwischen [!DNL Apache] Konfigurationen und Modulkonfigurationen.



## Auflösung

<br><br>Grundlegende Variablen verwenden<br><br><br><br> <br><br>
Da die Grundlinien-Dateien von AMS schreibgeschützt und unveränderlich sind, können Funktionen deaktiviert und aktiviert sowie durch Bearbeiten der von ihnen verwendeten Variablen konfiguriert werden.
<br><br><br><br> <br><br>Basisvariablen<br><br><br><br> <br><br>
Im Folgenden finden Sie ein Beispiel für den Inhalt der Datei <b>`/etc/httpd/conf.d/variables/ams_default.vars`</b>
<br><br><br><br><br> <br><br><br><br>

` Define DISP_LOG_LEVEL info Define AUTHOR_WHITELIST_ENABLED 0 Define PUBLISH_WHITELIST_ENABLED 0 Define AUTHOR_FORCE_SSL 1 Define PUBLISH_FORCE_SSL 0 `

<br><br><br><br><br> <br><br>Beispiel 1: SSL erzwingen<br><br><br><br> <br><br>
Die oben aufgeführten Variablen <b>`AUTHOR_FORCE_SSL`</b>oder <b>`PUBLISH_FORCE_SSL`</b> kann auf 1 gesetzt werden, um Umschreibungsregeln zu umschreiben, die Endbenutzer zwingen, beim Eintreffen auf eine HTTP-Anfrage zu HTTPS umgeleitet zu werden

Die folgende Syntax der Konfigurationsdatei ermöglicht es, diesen Umschalter zu verwenden:
<br><br><br><br><br> <br><br><br><br>

`/VirtualHost *:80      IfModule mod_rewrite.c          ReWriteEngine    on          If "${PUBLISH_FORCE_SSL} == 1" Include /etc/httpd/conf.d/rewrites/forcessl_rewrite.rules          /If      /IfModule /VirtualHost`

<br><br><br><br><br> <br><br>
Wie Sie sehen können, enthalten die Neuschreibungsregeln Folgendes: Der Code, um den Endbenutzer-Browser umzuleiten, aber die Variable, die auf 1 gesetzt ist, ermöglicht die Verwendung oder Nichtverwendung der Datei
<br><br><br><br> <br><br>Beispiel 2: Protokollierungsstufe<br><br><br><br> <br><br>
Die Variablen <b>`DISP_LOG_LEVEL`</b> kann verwendet werden, um festzulegen, was Sie für die Protokollebene wünschen, die tatsächlich in der laufenden Konfiguration verwendet wird.

Im Folgenden finden Sie ein Syntaxbeispiel, das in den grundlegenden AMS-Konfigurationsdateien vorhanden ist:
<br><br><br><br><br> <br><br><br><br>

`IfModule disp_apache2.c      DispatcherLog    logs/dispatcher.log      DispatcherLogLevel ${DISP_LOG_LEVEL} /IfModule`

<br><br><br><br><br> <br><br>
Wenn Sie die Dispatcher-Protokollierungsstufe erhöhen müssen, aktualisieren Sie einfach die `ams_default.vars` Variable <b>`DISP_LOG_LEVEL`</b> auf die gewünschte Ebene.

Beispielwerte können eine Ganzzahl oder das Wort sein:
<br><br><br><br> <br>

| Protokollebene | Ganzzahlwert | Wortwert |
| --- | --- | --- |
| Trace | 4 | trace |
| Debug | 3 | debug |
| Info | 2 | Info |
| Warnung | 1 | warn |
| Fehler | 0 | error |

<br><br><br> <br><br>Beispiel 3: Whitelists<br><br><br><br> <br><br>
Die Variablen <b>`AUTHOR_WHITELIST_ENABLED`</b> und <b>`PUBLISH_WHITELIST_ENABLED`</b> kann auf 1 gesetzt werden, um Umschreibungsregeln zu aktivieren, die Regeln enthalten, die den Endbenutzer-Traffic basierend auf IP-Adressen zulassen oder verbieten.  Das Umschalten dieser Funktion auf muss auch mit dem Erstellen einer Whitelist-Regeldatei kombiniert werden, damit sie eingeschlossen wird.

Im Folgenden finden Sie einige Syntaxbeispiele, wie die -Variable die Includes der Whitelist-Dateien und ein Beispiel für eine Whitelist-Datei aktiviert

<b>`sample.vhost`:</b>
<br><br><br><br><br> <br><br><br><br>

`VirtualHost *:80      Directory /          If "${AUTHOR_WHITELIST_ENABLED} == 1"              Include /etc/httpd/conf.d/whitelists/*_whitelist.rules          /If      /Directory /VirtualHost`

<br><br><br><br><br> <br><br>
<b>`sample_whitelist.rules`</b>:
<br><br><br><br><br> <br><br><br><br>

`RequireAny    Require ip 10.43.0.10/24 /RequireAny`

<br><br><br><br><br> <br><br>
Sie können die *`sample_whitelist.rules`* erzwingt die IP-Beschränkung, aber durch Umschalten der Variable kann sie in die Variable *`sample.vhost`*
<br><br><br><br> <br><br>Platzieren der Variablen<br><br><br><br> <br><br>Argumente zum Starten von Webservern<br><br><br><br> <br><br>
AMS setzt globale Variablen in die Startargumente der [!DNL Apache] Prozess in der Datei <b>`/etc/sysconfig/httpd`</b>

Diese Datei enthält vordefinierte Variablen, wie im Folgenden gezeigt:
<br><br><br><br><br> <br><br><br><br>

AUTHOR_IP=&quot;10.43.0.59&quot; AUTHOR_PORT=&quot;4502&quot; AUTHOR_DOCROOT=&#39;/mnt/var/www/author&#39; PUBLISH_IP=&quot;10.43.0.20&quot; PUBLISH_PORT=&quot;4503&quot; BLISH_DOCROOT=&#39;/mnt/var/www/html&#39; ENV_TYPE=&#39;dev&#39; RUNMODE=&#39;dev&#39;

<br><br><br><br><br> <br><br>
Dies können Sie nicht ändern, sind aber gut zu nutzen in Ihren Konfigurationsdateien

Hinweis:

Da diese Datei nur beim Starten des Dienstes eingeschlossen wird.  Um Änderungen aufzunehmen, ist ein Neustart des Dienstes erforderlich.  Das bedeutet, dass eine Neuladung nicht ausreicht, sondern stattdessen ein Neustart erforderlich ist


<br><br><br><br> <br><br>Variablendateien (`.vars`)<br><br><br><br> <br><br>
Benutzerdefinierte Variablen, die von Ihrem Code bereitgestellt werden, sollten in *`.vars`*Dateien im Verzeichnis <b>`/etc/httpd/conf.d/variables/`</b>

Diese Dateien können beliebige benutzerdefinierte Variablen enthalten. Syntaxbeispiele finden Sie in den folgenden Beispieldateien

<b>`/etc/httpd/conf.d/variables/weretail_domains_dev.vars`</b>:
<br><br><br><br><br> <br><br><br><br>

`Define WERETAIL_DOMAIN dev.weretail.com Define WERETAIL_ALT_DOMAIN dev.weretail.net`

<br><br><br><br><br> <br><br>
<b>`/etc/httpd/conf.d/variables/weretail_domains_stage.vars`:</b>
<br><br><br><br><br> <br><br><br><br>

`Define WERETAIL_DOMAIN stage.weretail.com` `Define WERETAIL_ALT_DOMAIN stage.weretail.net`


<br><br><br><br><br> <br><br>
<b>`/etc/httpd/conf.d/variables/weretail_domains_prod.vars`</b>:
<br><br><br><br><br> <br><br><br><br>

`Define WERETAIL_DOMAIN www.weretail.com Define WERETAIL_ALT_DOMAIN www..weretail.net`

<br><br><br><br><br> <br><br>
Bei der Erstellung Ihrer eigenen Variablen benennen Sie sie anhand ihres Inhalts und folgen Sie den im Handbuch angegebenen Benennungsstandards. [here](https://helpx.adobe.com/experience-manager/kb/ams-dispatcher-manual/explanation-config-files.html#naming-convention).  Im obigen Beispiel sehen Sie, dass die Variablendatei die verschiedenen DNS-Einträge als Variablen hostet, die in den Konfigurationsdateien verwendet werden sollen.
<br><br><br><br> <br><br>Verwenden von Variablen<br><br><br><br> <br><br>
Nachdem Sie Ihre Variablen in Ihren Variablendateien definiert haben, sollten Sie wissen, wie Sie sie in Ihren anderen Konfigurationsdateien ordnungsgemäß verwenden können.

Wir verwenden das Beispiel `.vars` -Dateien aus dem obigen Abschnitt, um einen geeigneten Anwendungsfall zu veranschaulichen.

Wir möchten alle umgebungsbasierten Variablen global einbeziehen. Wir werden die Datei erstellen <b>`/etc/httpd/conf.d/000_load_env_vars.conf`</b>

`Include /etc/httpd/conf.d/variables/*_${ENV_TYPE}.vars Include /etc/httpd/conf.d/variables/*_${RUNMODE}.vars`

<br><br><br><br><br> <br><br>
Wir wissen, dass der HTTPD-Dienst beim Start die von AMS festgelegten Variablen in abruft <b>`/etc/sysconfig/httpd`</b> und verfügt über den Variablensatz von <b>`ENV_TYPE`</b> und <b>`RUNMODE`</b>

Wenn diese globale `.conf` -Datei abgerufen wird, wird sie frühzeitig abgerufen, da die Include-Reihenfolge der Dateien in `conf.d` ist alphanumerische Ladereihenfolge bedeutet 000 im Dateinamen, dass er vor den anderen Dateien im Verzeichnis geladen wird.

Die Include-Anweisung verwendet auch eine Variable im Dateinamen.  Dadurch kann sich ändern, welche Datei tatsächlich geladen wird, basierend darauf, welcher Wert in der Variablen `ENV_TYPE` und `RUNMODE` Variablen.

Wenn die Variable *`ENV_TYPE`* Wert ist <b>`dev`</b> dann wird die Datei verwendet:

<b>`/etc/httpd/conf.d/variables/weretail_domains_dev.vars`</b>

Wenn die Variable *`ENV_TYPE`* Wert ist <b>`stage`</b> dann wird die Datei verwendet:

<b>`/etc/httpd/conf.d/variables/weretail_domains_stage.vars`</b>

Wenn die Variable `RUNMODE` Wert ist <b>`preview`</b> dann wird die Datei verwendet:

<b>`/etc/httpd/conf.d/variables/weretail_domains_preview.vars`</b>

Wenn diese Datei eingeschlossen wird, können wir die darin gespeicherten Variablennamen verwenden.

In unserem <b>`/etc/httpd/conf.d/available_vhosts/weretail.vhost`</b> -Datei können wir die normale Syntax austauschen, die nur für dev funktioniert hat:


```
VirtualHost *:80      ServerName    dev.weretail.com      ServerAlias    dev.weretail.net |
```

Mit einer neueren Syntax, die die Leistungsfähigkeit von Variablen nutzt, um für Entwicklung, Staging und Produktion zu funktionieren:

```
VirtualHost *:80      ServerName    ${WERETAIL_DOMAIN}      ServerAlias    ${WERETAIL_ALT_DOMAIN}
```


In unserem <b>`/etc/httpd/conf.dispatcher.d/vhosts/weretail_vhosts.any`</b> -Datei können wir die normale Syntax austauschen, die nur für dev funktioniert hat:


```
"dev.weretail.com" "dev.weretail.net"
```


Die neuere Syntax, die die Leistungsfähigkeit von Variablen nutzt, um für Entwicklung, Staging und Produktion zu arbeiten:


```
"${WERETAIL_DOMAIN}" "${WERETAIL_ALT_DOMAIN}" 
```

<br><br><br><br><br> <br><br>
Diese Variablen können sehr häufig wiederverwendet werden, um laufende Einstellungen zu individualisieren, ohne dass je Umgebung unterschiedliche bereitgestellte Dateien benötigt werden.  Im Grunde nehmen Sie Ihre Konfigurationsdateien mit Variablen als Vorlage vor und schließen Dateien ein, die auf Variablen basieren.
