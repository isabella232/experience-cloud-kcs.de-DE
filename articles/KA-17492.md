---
title: Analysieren AEM Indizierungsprobleme
description: Beschreibung
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: 10/21/2021 5:47:49 PM
article-published-by: Cedric Latimier
article-published-date: 1/6/2022 9:04:25 AM
version-number: 1
article-number: KA-17492
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=846ba2fc-9632-ec11-b6e5-000d3a5ba97a
exl-id: 59a10140-0386-42f8-bd1a-a934a2276ca5
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '858'
ht-degree: 0%

---

# Analysieren AEM Indizierungsprobleme

## Beschreibung


Ziel dieses Artikels ist es, Einzelheiten zur Fehlerbehebung bei allen gängigen Indizierungsproblemen zu erhalten.


## Auflösung

<br><br>Analysieren langsamer Abfragen<br><br><br><br> <br><br>
Unter Tools - Vorgänge - Dashboard - Diagnose - Abfrageleistung wird die Liste der langsamen Abfragen angezeigt.

Siehe [dieses Dokuments](https://docs.adobe.com/docs/en/aem/6-2/deploy/platform/queries-and-indexing.html#Troubleshooting%20indexing%20issues) für Details zur Analyse langsamer Abfragen.

In Nicht-Produktionsumgebungen kann das Tool-Paket ACS AEM installiert werden, um ein erklärtes Abfragetool für das weitere Debugging bereitzustellen.
<br><br><br><br> <br><br>Neuindizierung asynchroner Indizes<br><br><br><br><br><br>
Hinweis:

Die Neuindizierung löst in der Regel keine Abfrageprobleme, z. B. Abfragen, die nicht die richtigen Ergebnisse zurückgeben. Außerdem kann die Neuindizierung lange dauern, bis eine Neuindizierung vermieden wird, es sei denn, sie wird durch einen dort aufgeführten Grund abgedeckt.
<br><br><br><br> <br><br>
<b>Neuindizieren eines asynchronen Index</b>

- Melden Sie sich bei Ihrer AEM-Instanz an
- Öffnen Sie http://aemhost:port/crx/de/index.jsp
- Navigieren Sie zur Indexdefinition unter /oak:index .
- Legen Sie für den Index die boolesche Eigenschaft reindex=true fest, um ihn neu zu indizieren, und speichern Sie dann. Wenn die Indizierung beginnt, wird eine Protokollmeldung wie die folgende angezeigt:


23.06.2015 14:26:23.070 \*INFO\* FelixStartLevel org.apache.jackrabbit.oak.plugins.index.IndexUpdate Die Neuindizierung wird für folgende Indizes durchgeführt: /oak:index/cqAcUUID, /oak:index/nodetype, /oak:index/deviceIdentificationMode, /oak:index/campaignpath, /oak:index/active, /oak:index/jcrFrozenMixinTypes

- Während die Neuindizierung läuft, hat das Attribut &quot;status&quot;von IndexStatsMBean den Wert &quot;running&quot;.

 23.06.2015 14:26:23.517 \*INFO\* FelixStartLevel org.apache.jackrabbit.oak.plugins.index.IndexUpdate Neuindizierung Durchlaufen #10000 /jcr:system/jcr:versionStorage/c8/5f..23.06.201514:28:51.999 \*INFO\* pool-8-thread-1 org.apache.jackrabbit.oak.plugins.index.IndexUpdate Indizierungsbericht - /oak:index/counter\*(708) - /oak:index/authorizables\*(159) - /oak:index/cqPageLucene\*(1 913) - /oak:index/ntBaseLucene\*(444) - /oak:index/cqTagLucene\*(512) - /oak:index/workflowDataLucene\*(116)
- Sie können bestätigen, dass die Indizierung abgeschlossen wurde, indem Sie Ihren Indexdefinitionsknoten überprüfen, die Eigenschaft reindexCount hätte erhöht werden müssen und der boolesche Neuindizierungswert auf &quot;false&quot;gesetzt werden sollte

   Wenn die Indizierung erfolgreich abgeschlossen wurde, wird in der Protokolldatei der folgende Eintrag angezeigt

23.06.2015 14:28:52.009 \*INFO\* pool-8-thread-1 org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate Neuindizierung (async) abgeschlossen für Indizes: /oak:index/counter\*(708), /oak:index/authorizables\*(159), /oak:index/cqPageLucene\*(1913), /oak:index/ntBaseLucene\*(444), /oak:index/cqTagLucene\*(5 12), /oak:index/workflowDataLucene\*(116) in 30.36 s
- Wenn die Neuindizierung nicht abgeschlossen wird und in eine Schleife gegangen ist, sehen Sie sich die [Abschnitt unten](https://helpx.adobe.com/experience-manager/kb/Analyzing-AEM-Indexing-Issues.html#Analyzing_Failed_Reindexing).


Die asynchrone Indexaktivität kann auf INFO-Ebene identifiziert werden, indem sie auf org.apache.jackrabbit.plugins.index.IndexUpdate und org.apache.jackrabbit.plugins.index.AsyncIndexUpdate übergeht.
 <br><br>Leistungsprobleme bei der asynchronen Indizierung<br><br><br><br> 
- Aktivieren Sie die Protokollierung, um den Zeitpunkt zu überprüfen:


TRACE-Ebene (nur in Oak 1.0.17 oder höher):

org.apache.jackrabbit.oak.plugins.index.lucene.LuceneIndexEditorContext.perf

DEBUG-Ebene:

org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate

org.apache.jackrabbit.oak.plugins.index.IndexUpdate

org.apache.jackrabbit.oak.plugins.index.lucene.LuceneIndexEditor

org.apache.jackrabbit.oak.plugins.index.lucene.IndexTracker

org.apache.jackrabbit.oak.plugins.index.lucene.LuceneIndexEditorContext

org.apache.jackrabbit.oak.plugins.index.lucene.IndexCopier

Protokolle wie diese würden generiert und zeigen den Zeitpunkt der Indizierung:

09.07.2015 08:13:38.401 \*TRACE\* 192.168.193.1 1436444018387 POST /content/dam/site/test.createasset.html HTTP/1.1 org.apache.jackrabbit.oak.jcr.operations.writes session-1017 Knoten hinzufügen /content/dam/site/test/jackrabbit-oak7.png 09.07.2015 08:13:38.583 \*TRACE\* 192.168.193.1 1436444018387 POST /content/dam/site/test.createasset.html HTTP/1.1 org.apache.jackrabbit.oak.jcr.operations.writes session-1017 77 Speichern 09.07.2015 08:13:42.823 \*DEBUG\* pool-9-thread-1 org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate Running background index task async 09.07.2015 08:13:42.963 \*TRACE\* pool-9-thread-1 org.apache.jackrabbit.oak.plugins.index.lucene.LuceneIndexEditor /oak:index/lucene Indiziertes Dokument für /content/dam/site/test/jackrabbit-oak7.png/jcr:content/related ist Documentstored,indexed,omitNorms,indexOptions=DOCS_ONLY:path:/content/dam/site/test/jackrabbit-oak7.png/jcr:content/related indexed,tokenized:fulltext:verwandtes 09.07.2015 08:13:43.579 \*DEBUG\* pool-9-thread-1 org.apache.jackrabbit.oak.plugins.index.IndexUpdate Indizierungsbericht
- /oak:index/siteDamIndex(2)
- /oak:index/lucene(15)

09.07.2015 08:13:43.779 \*TRACE\* oak-lucene-0 org.apache.jackrabbit.oak.plugins.index.lucene.IndexTracker.perf /oak:index/siteDamIndex wurde für aktualisiert gefunden. Das erneute Öffnen des IndexNode dauerte 150ms 09.07.2015 08:13:45.248 \*TRACE\* oak-lucene-0 org.apache.jackrabbit.oak.plugins.index.lucene.IndexCopier.perf /oak:index/lucene Kopierte 0 Dateien insgesamt 0 B 1465ms 09.07.2015 08:13:45.248 \*TRACE\* oak-lucene-0 org.apache.jackrabbit.oak.plugins.index.lucene.IndexCopier /oak:index/lucene nur entfernte Dateisegmente öffnen.gen 09.07.2015 08:13:45.361 \*TRACE\* oak-lucene-0 org.apache.jackrabbit.oak.plugins.index.lucene.IndexTracker.perf /oak:index/lucene Index wurde aktualisiert. Das erneute Öffnen des IndexNode dauerte 1581 ms

- Nehmen Sie eine Reihe von Thread-Sicherheitskopien und suchen Sie nach dem Thread, der AsyncIndexUpdate im Stapel enthält, um zu sehen, wo der Großteil der Indizierungszeit verbracht wird oder ob die Indizierung auf einige andere Threads wartet. Informationen zu Thread-Sicherheitskopien finden Sie unter [diesem Artikel](https://helpx.adobe.com/experience-manager/kb/TakeThreadDump.html).
- Legen Sie die boolesche Eigenschaft saveDirectoryListing=true fest (nur bei Verwendung von Oak 1.0.16, wenn spätere Version dann nicht erforderlich ist) und legen Sie die Eigenschaft excludedPaths=/var, /etc/workflow/instances, /jcr:system auf dem OOTB-Index /oak:index/lucene fest, um sie zu optimieren.
- Klicken Sie auf „Alle speichern“.
- Wenn Sie benutzerdefinierte Lucene-Eigenschaftenindizes erstellen, stellen Sie sicher, dass Sie saveDirectoryListing=true (Boolesch) festlegen, wenn Sie Oak 1.0.16 verwenden und die Eigenschaft includedPaths (String) so festlegen, dass Ihr Index auf die Indexierung bestimmter Pfade beschränkt wird.


Gehen Sie zu dieser URL /system/console/configMgr/org.apache.jackrabbit.oak.plugins.index.lucene.LuceneIndexProviderService &quot;Copy on Read&quot;, &quot;Copy on Write&quot;(nur sicher zur Verwendung in Oak 1.0.18 und höher) und &quot;Prefetch Index Files&quot;(nur in Oak 1.0.18 und höher).
<br><br><br>Fehlgeschlagene Neuindizierung analysieren<br><br><br><br>
- Wenn die asynchrone Indizierung fehlschlägt und Sie die asynchrone Indexerstats-JMX-Benutzeroberfläche (Link unten) überprüfen, sehen Sie, dass LastIndexedTime ein altes Datum und eine alte Uhrzeit ist:


http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aid%3D11%2Cname%3D&quot;async&quot;%2Ctype%3D&quot;IndexStats&quot;

- Wenn die Neuindizierung fehlschlägt, wird sie in eine Schleife wie die folgende eingefügt:


08.01.2015 01:22:04.474 \*INFO\* pool-9-thread-2 org.apache.jackrabbit.oak.plugins.index.IndexUpdate Die Neuindizierung wird für die folgenden Indizes durchgeführt: /oak:index/damFileSize, /oak:index/lucene, /oak:index/cqLastModified08.01.20 15 01:52:08.365 \*INFO\* pool-9-thread-5 org.apache.jackrabbit.oak.plugins.index.IndexUpdate Die Neuindizierung wird für die folgenden Indizes durchgeführt: /oak:index/damFileSize, /oak:index/lucene, /oak:index/cqLastModified08.01.20 15 09:33:23.306 \*INFO\* pool-9-thread-5 org.apache.jackrabbit.oak.plugins.index.IndexUpdate Die Neuindizierung wird für die folgenden Indizes durchgeführt: /oak:index/damFileSize, /oak:index/lucene, /oak:index/cqLastModified

- Wenn Sie dies sehen, sollten Sie die Protokollierung auf Debug-Ebene für org.apache.jackrabbit.oak.plugins.index aktivieren


- Wenn die Indizierung das nächste Mal mit der Protokollmeldung über einer Debug-Protokollmeldung oben Schleife durchläuft, erhalten Sie weitere Details, warum die Indizierung fehlschlägt.  Dann können Sie das Problem lösen, ob es sich um einen beschädigten Knoten, einen fehlenden Blob oder ein anderes Problem handelt.
