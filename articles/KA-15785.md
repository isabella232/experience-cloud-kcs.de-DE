---
title: Campaign Classic V7 - im Datenbankaktualisierungs-Assistenten generierte SQL-Abfrage optimieren
description: Beschreibung
solution: Campaign,Campaign Classic v7
product: Campaign,Campaign Classic v7
applies-to: Campaign Classic,Campaign,Campaign Classic v7
keywords: KCS
resolution: Resolution
internal-notes: It can be helpful when dealing with database update issues with big tables
bug: true
article-created-by: Marta Zator
article-created-date: 5/5/2022 10:16:35 AM
article-published-by: Marta Zator
article-published-date: 5/5/2022 10:18:58 AM
version-number: 2
article-number: KA-15785
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=e810bb6a-5ccc-ec11-a7b5-6045bd00dbbc
exl-id: 73e8701c-88e5-4b73-8c55-90eaee26d2ac
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '366'
ht-degree: 1%

---

# Campaign Classic V7 - im Datenbankaktualisierungs-Assistenten generierte SQL-Abfrage optimieren

## Beschreibung


<b>Hintergrund und Kontext :</b>
In den meisten Campaign-Builds einschließlich Gold Standard 9032 treten möglicherweise mehrere Probleme auf, wenn einem vorhandenen Schema neue Spalten hinzugefügt werden.

Dieser Artikel befasst sich mit einem spezifischen Problem, das sich auf Folgendes bezieht:

- Hinzufügen eines ganzzahligen Felds zu einem vorhandenen Schema, wenn bereits Datensätze vorhanden sind.
- Optimieren Sie die von der Anwendung erzeugte SQL-Abfrage auf eine effiziente für Postgres SQL.


<b>Anwendungsfall :</b> 
<br>Wir haben eine existierende Empfängertabelle oder eine andere Tabelle, die bereits über 1 Million Datensätze verfügt.
<br>Jetzt muss dieser Tabelle eine zusätzliche Spalte hinzugefügt werden, die vom Datentyp Integer ist.
<br>Wir fügen diese Spalte zur Schemadefinition hinzu und möchten die Änderungen in der Datenbank übernehmen.

<b>Herausforderung </b>:
<br>Bei der Aktualisierung der Datenbank tritt ein Problem auf, und bei der Datenbank tritt ein Deadlock auf oder die Abfrage blockiert andere Vorgänge.
<br>Dies liegt hauptsächlich an der Aktualisierung aller Datensätze auf 0, basierend auf dem SQL-Befehl, der vom Datenbankassistenten generiert wurde.


<br> <br>

## Auflösung


Lösung :

Beim Hinzufügen einer ganzzahligen Spalte wird die SQL-Anweisung wie folgt generiert:

<b>ALTER TABLE NmsRecipient ADD column_name SMALLINT;
<br>UPDATE NmsRecipient SET column_name = 0;
<br>ALTER TABLE NmsRecipient ALTER COLUMN column_name SET Standard 0;
<br>ALTER TABLE NmsRecipient ALTER COLUMN icolColumn_name SET NOT NULL;</b>

Das Problem besteht darin, dass in der Datenbank vier parallel ausgeführte Befehle ausgeführt werden, die Leistungsprobleme oder Deadlock verursachen können.

Die Lösung besteht darin, diese vier Befehle zu einem zusammenzufassen und dennoch die folgenden Änderungen vorzunehmen:

<b>ALTER TABLE NmsRecipient ADD FileLiveDataCliqueurs SMALLINT NOT NULL SET Standard 0 ;</b>

Sie nimmt alle erforderlichen Änderungen vor, fügt die Spalte hinzu, legt die Standardeinstellung fest, legt NOT NULL fest und setzt den Wert der vorhandenen Datensätze aufgrund der NOT NULL-Beschränkung auf 0.



<b>HINWEIS :</b>

Wenn mehrere ganzzahlige Spalten hinzugefügt werden müssen, fügen Sie sie einzeln hinzu und führen Sie den Datenbankassistenten für jede Änderung aus.

Dies soll einen reibungslosen Betrieb sicherstellen, da die Anweisung alle <b>vorhandene </b>-Datensätze ebenfalls auf 0 gesetzt werden, und zwar je nach Anzahl. von Datensätzen kann es Zeit dauern.
