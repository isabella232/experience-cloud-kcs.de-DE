---
title: Campaign Classic V7 - Was ist das Datenbankmodul pg_stat_statement? Wozu dient es?
description: Beschreibung
solution: Campaign,Campaign Classic v7
product: Campaign,Campaign Classic v7
applies-to: Campaign Classic,Campaign,Campaign Classic v7
keywords: KCS
resolution: Resolution
internal-notes: https://wiki.corp.adobe.com/pages/viewpage.action?spaceKey=neolane&title=Database+performance+optimization+-+Identify+bottleneck+queries+with+execution+statistics#Databaseperformanceoptimization-Identifybottleneckquerieswithexecutionstatistics-pg_stat_statements
bug: false
article-created-by: Marta Zator
article-created-date: 5/4/2022 4:36:53 PM
article-published-by: Marta Zator
article-published-date: 5/4/2022 4:38:25 PM
version-number: 2
article-number: KA-14829
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=aa74c765-c8cb-ec11-a7b5-6045bd00d4f5
exl-id: ad0f34e4-bf33-4eef-a290-7b0a3e92a6c9
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '350'
ht-degree: 1%

---

# Campaign Classic V7 - Was ist das Datenbankmodul pg_stat_statement? Wozu dient es?

## Beschreibung


1. Was ist db module pg_stat_statement?

2. Warum wird die Aktivierung von Kunden angefordert?

3. Wie wird sie aktiviert?






## Auflösung




1.  Das Modul pg_stat_statement bietet eine Möglichkeit, Ausführungsstatistiken aller von einem Server ausgeführten SQL-Anweisungen zu verfolgen.

Das Modul muss durch Hinzufügen von pg_stat_statement zu shared_preload_libraries in postgresql.conf geladen werden, da es zusätzlichen gemeinsamen Speicher erfordert. Dies bedeutet, dass zum Hinzufügen oder Entfernen des Moduls ein Neustart des Servers erforderlich ist.

Link : [https://www.postgresql.org/docs/9.4/pgstatstatements.html](https://www.postgresql.org/docs/9.4/pgstatstatements.html)



2. Um ein Ansichtstyp-Schema für diese Tabelle zu implementieren, mit dem wir Abfragen überwachen können, die lange dauern. Auf diese Weise können Kunden diese anpassen und die Leistung optimieren.

Diese Erweiterung bietet Metriken zu laufenden Abfragen : welche die am häufigsten ausgeführten Abfragen sind und wie lange sie dauern.



3.  <b>pg_stat_statement </b>

1. Stellen Sie sicher, dass das offizielle PostgreSQL Contrib-Paket für die Postgres-Version installiert ist.

$ dpkg -l | grep postgres postgresql-contributing-9.3

Wenn es nicht installiert ist, installieren Sie es.

$ apt-get install postgresql-contributing-9.3

2. Ändern Sie postgresql.conf so, dass das Modul beim Start vorab geladen wird.

Standard : shared_preload_libraries = &#39;&#39; Neu : shared_preload_libraries = &#39;pg_stat_statement&#39; — bei Verwendung sowohl von pg_stat_instructions als auch von auto_erklären verwenden Sie EINEN Datensatz und trennen Sie ihn von den Kommas shared_preload_libraries = &#39;auto_statement,pg_stat_statement&#39;.

3. Führen Sie in der Datenbank, die Sie überwachen möchten, CREATE query aus:

— Keine Erweiterungserstellung erforderlich für auto_Exploration, nur für pg_stat_statement psql postgres=# \c mydatabase mydatabase=# CREATE EXTENSION pg_stat_statement;

4. Fügen Sie im Abschnitt &quot;BENUTZERDEFINIERTE OPTIONS&quot;von postgresql.conf die folgenden Zeilen hinzu:

pg_stat_statement.max = 5000 pg_stat_statement.track = all pg_stat_statement.save = on

5. Beispiel für einen Postgresql-Dienst neu starten : Die fünf kostenintensivsten Abfragen in Datenbanken

SELECT-Abfrage, Aufrufe, total_time, Zeilen, 100.0\*shared_blks_hit/nullif(shared_blks_hit+shared_blks_read,0) AS hit_percent von pg_stat_Statements als innerer Join pg_database wie d auf d.oid = s.dbid, wobei d.datname = &#39;Database_Name&#39;-Reihenfolge nach total_deslimit 5;
